#include<bits/stdc++.h>
using namespace std;
const int inf=0x3f3f3f3f;
int T,n,a[20][20],now[20][20];
int dx[5]={0,-1,-1,-2,1},dy[5]={0,-1,0,0,-1};

int read()
{
    int x=0;
    char ch=getchar();
    while(ch<'0'||ch>'9') ch=getchar();
    while(ch>='0'&&ch<='9') x=x*10+ch-'0',ch=getchar();
    return x;
}

int check(int x)
{
    int ans=0;
    for(int i=n;i;i--,x>>=1)
    {
	if((x&1)==0&&a[1][i]==1) return inf;
	now[1][i]=(x&1);
	ans+=now[1][i]-a[1][i];
    }
    for(int x=2;x<=n;x++)
	for(int y=1;y<=n;y++)
	{
	    int sum=0;
	    for(int i=1;i<=4;i++)
		sum+=now[x+dx[i]][y+dy[i]];
	    if(sum%2==0&&a[x][y]==1) return inf;
	    now[x][y]=sum%2;
	    ans+=now[x][y]-a[x][y];
	}
    return ans;
}

int main()
{
    T=read();
    for(int cas=1;cas<=T;cas++)
    {
	n=read();
	for(int i=1;i<=n;i++)
	    for(int j=1;j<=n;j++) 
		a[i][j]=read();
	int ans=inf,tot=(1<<n);
	for(int i=0;i<tot;i++)
	    ans=min(ans,check(i));
	printf("Case %d: ",cas);
	if(ans==inf) printf("-1\n");
	else printf("%d\n",ans);
    }
    return 0;
}
